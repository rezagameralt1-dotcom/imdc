# Fail2ban filter for IMDC Nginx JSON access logs
# Matches abusive clients based on HTTP status codes (401/403/404/429/500-range).
#
# Example logged line (single line JSON):
# {"time_local":"...","remote_addr":"1.2.3.4","request_method":"GET","status":429,...,"uri":"/api/...", "trace_id":"..."}
#
# Fail2ban parses raw lines; we extract remote_addr and status.
# Note: (?P<host>...) is required to capture the IP for banning.
[Definition]
failregex = ^\{.*"remote_addr":"(?P<host>(?:\d{1,3}\.){3}\d{1,3})".*"status":(?:401|403|404|429|5\d{2}).*\}$
ignoreregex =
